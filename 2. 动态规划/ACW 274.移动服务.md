一个公司有三个移动服务员，最初分别在位置 $1，2，3$ 处。

如果某个位置（用一个整数表示）有一个请求，那么公司必须指派某名员工赶到那个地方去。

某一时刻只有一个员工能移动，且不允许在同样的位置出现两个员工。

从 $p$ 到 $q$ 移动一个员工，需要花费 $c(p,q)$。

这个函数不一定对称，但保证 $c(p,p)=0$。

给出 $N$ 个请求，请求发生的位置分别为 $p_1 \sim p_N$。

公司必须按顺序依次满足所有请求，**且过程中不能去其他额外的位置**，目标是最小化公司花费，请你帮忙计算这个最小花费。

#### 输入格式

第 $1$ 行有两个整数 $L,N$，其中 $L$ 是位置数量，$N$ 是请求数量，每个位置从 $1$ 到 $L$ 编号。

第 $2$ 至 $L+1$ 行每行包含 $L$ 个非负整数，第 $i+1$ 行的第 $j$ 个数表示 $c(i,j)$，并且它小于 $2000$。

最后一行包含 $N$ 个整数，是请求列表。

一开始三个服务员分别在位置 $1，2，3$。

#### 输出格式

输出一个整数 $M$，表示最小花费。

#### 数据范围

$3 \le L \le 200$,  
$1 \le N \le 1000$

#### 输入样例：

```
5 9
0 1 1 1 1
1 0 2 3 2
1 1 0 4 1
2 1 5 0 1
4 2 3 4 0
4 2 4 1 5 4 3 2 1
```

#### 输出样例：

```
5
```


## 题解
我们本题因为我们的数据范围较小，我们考虑 dp，我们发现，从一个原始状态转移到一个新状态，我们这一题的难点在于怎么表示出有用的状态，让我们能够简单的解决这个问题。

如果发现，DP 的阶段就是已经完成的请求数量，通过指派一名服务员，可以把一个“完成 i-1”个请求的状态转移到完成 i 个请求的状态。
于是我们直接设 $F[i][x][y][z]$ 表示我们完成了前 i 个请求，三个员工分别位于 x, y, z 时，公司的最小花费。

于是我们每一次从前往后递推就可以写出：
$F[i+1,p_{i+1},y,z]=min(F(i+1,p_{i+1},y,z)),F(i,x,y,z)+c(x,p)$
题目要求同一个位置不能出现两个员工，我们另外需要 if 语句来判断状态转移的合法性。

优化：
观察后我们可以发现：在第 i 个请求完成时，一定有某个员工位于 $p_{i}$,我们只需要直到阶段 i 和另外两个员工的位置接口，因此我们可以用 $F[i,x,y]$ 表示我们的状态，那么我们的转移就是：
![[Pasted image 20231013171527.png]]