# [ABC 212 G] Power Pair

## 题面翻译

给定质数 $P$，求有多少个整数 $x,y$，满足

- $0\le x,y\le P-1$

- $\exist n\in \mathbb{N},x^n\equiv y\pmod p$

Translated by @ternary_tree

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc212/tasks/abc212_g

素数 $ P $ が与えられます。

以下の条件を満たす整数の組 $ (x,\ y) $ はいくつありますか？

- $ 0\ \leq\ x\ \leq\ P-1 $
- $ 0\ \leq\ y\ \leq\ P-1 $
- ある正整数 $ n $ が存在して、$ x^n\ \equiv\ y\ \pmod{P} $ を満たす

ただし答えは非常に大きくなる可能性があるので、$ 998244353 $ で割った余りを出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ P $

## 输出格式

答えを $ 998244353 $ で割った余りを出力せよ。

## 样例 #1

### 样例输入 #1

```
3
```

### 样例输出 #1

```
4
```

## 样例 #2

### 样例输入 #2

```
11
```

### 样例输出 #2

```
64
```

## 样例 #3

### 样例输入 #3

```
998244353
```

### 样例输出 #3

```
329133417
```

## 提示

### 制約

- $ 2\ \leq\ P\ \leq\ 10^{12} $
- $ P $ は素数

### Sample Explanation 1

$ (x,\ y)\ =\ (0,\ 0),\ (1,\ 1),\ (2,\ 1),\ (2,\ 2) $ の $ 4 $ 組が条件を満たします。

## 题解
本题，我们有一个特征 $a^{n}=b$，这个时候，我们可以通过**枚举我们的 i**，然后求有多少个对应的 $j$ 满足要求来计算得到。我们首先吧我们的 $i=1$ 的情况单独处理，这个时候，我们一定有：j 唯一只能为 1，于是我们这个时候的答案就是 $1$,然后我们在对其他的数字进行处理。

显然可以发现，题目可以变为枚举 $x$,算出对于 $x$ 的次幂模 $p$ 所能产生的数的个数。记为 $\delta_p(x)$
当 $p$ 为质数时，$\forall i,0\leq i<p$ 均存在 $j$ 使得 $i^j\equiv1\pmod{p}$。
我们可以发现，$\delta_p(i)$ 为最小的 $j$,即阶。


注意可以 $x=y=0$,所以原题可以变为：
$$1+\sum_{x=1}^{\varphi(p)}\frac{\varphi(p)}{\gcd(\varphi(p),x)}$$


我们令 $n=\varphi(p):$
$$\begin{aligned}\sum_{x=1}^n\frac n{\gcd(n,x)}&=\sum_{d|n}\sum_{x=1}^{\frac nd}\frac nd[\gcd(n,xd)=d]\\&=\sum_{d|n}\sum_{x=1}^{\frac nd}\frac nd[\gcd(\frac nd,x)=1]\\&=\sum_{d|n}d\sum_{x=1}^d[\gcd(d,x)=1]\\&=\sum_{d|n}d\varphi(d)\end{aligned}$$


最后，我们不难得到我们的最终的答案为：