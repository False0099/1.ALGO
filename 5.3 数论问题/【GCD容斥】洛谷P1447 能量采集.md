# [NOI 2010] 能量采集

## 题目描述

栋栋有一块长方形的地，他在地上种了一种能量植物，这种植物可以采集太阳光的能量。在这些植物采集能量后，栋栋再使用一个能量汇集机器把这些植物采集到的能量汇集到一起。

栋栋的植物种得非常整齐，一共有 $n$ 列，每列有 $m$ 棵，植物的横竖间距都一样，因此对于每一棵植物，栋栋可以用一个坐标 $(x, y)$ 来表示，其中 $x$ 的范围是 $1$ 至 $n$，$y$ 的范围是 $1$ 至 $m$，表示是在第 $x$ 列的第 $y$ 棵。

由于能量汇集机器较大，不便移动，栋栋将它放在了一个角上，坐标正好是 $(0, 0)$。

能量汇集机器在汇集的过程中有一定的能量损失。如果一棵植物与能量汇集机器连接而成的线段上有 $k$ 棵植物，则能量的损失为 $2k + 1$。例如，当能量汇集机器收集坐标为 $(2, 4)$ 的植物时，由于连接线段上存在一棵植物 $(1, 2)$，会产生 $3$ 的能量损失。注意，如果一棵植物与能量汇集机器连接的线段上没有植物，则能量损失为 $1$。现在要计算总的能量损失。

下面给出了一个能量采集的例子，其中 $n = 5$，$m = 4$，一共有 $20$ 棵植物，在每棵植物上标明了能量汇集机器收集它的能量时产生的能量损失。

![](https://cdn.luogu.com.cn/upload/image_hosting/fhzpmm7b.png)

在这个例子中，总共产生了 $36$ 的能量损失。

## 输入格式

一行两个整数 $n,m$。

## 输出格式

仅包含一个整数，表示总共产生的能量损失。

## 样例 #1

### 样例输入 #1

```
5 4
```

### 样例输出 #1

```
36
```

## 样例 #2

### 样例输入 #2

```
3 4
```

### 样例输出 #2

```
20
```

## 提示

- 对于 $10\%$ 的数据：$n, m \leq 10$；
- 对于 $50\%$ 的数据：$n, m \leq 100$；
- 对于 $80\%$ 的数据：$n, m \leq 10^3$；
- 对于 $90\%$ 的数据：$n, m \leq 10^4$；
- 对于 $100\%$ 的数据：$1 \leq n, m \leq 10^5$。

## 题解
注意到，我们两个元素如果在同一条直线上，一定满足：$gcd(i,j)=gcd(j,k)$。因此，我们就可以通过统计我们的 $gcd(i,j)$ 对应为 k 的元素有多少个，然后再去统计我们上面的每一个元素对于我们能量损失的贡献是多少即可。

```cpp
#include<cstdio>

#define N 100001

long long f[N];

int main()
{
	int n,m;
	scanf("%d%d",&n,&m);
	int nm=n<m ? n : m; 
	for(int i=nm;i;--i)
	{
		f[i]=1ll*(n/i)*(m/i);
		for(int j=i+i;j<=nm;j+=i) f[i]-=f[j];
	}
	long long ans=0;
	for(int i=1;i<=n;++i) ans+=f[i]*(2*i-1);
	printf("%lld",ans);
}

```