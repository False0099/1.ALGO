# [SDOI 2008] 仪仗队

## 题目描述

作为体育委员，C 君负责这次运动会仪仗队的训练。仪仗队是由学生组成的 $N \times N$ 的方阵，为了保证队伍在行进中整齐划一，C 君会跟在仪仗队的左后方，根据其视线所及的学生人数来判断队伍是否整齐（如下图）。

![](https://cdn.luogu.com.cn/upload/pic/1149.png)

现在，C 君希望你告诉他队伍整齐时能看到的学生人数。

## 输入格式

一行，一个正整数 $N$。

## 输出格式

输出一行一个数，即 C 君应看到的学生人数。

## 样例 #1

### 样例输入 #1

```
4
```

### 样例输出 #1

```
9
```

## 提示

对于 $100 \%$ 的数据，$1 \le N \le 40000$。

## 题解
我们首先观察，一个数如果可以被看见，那么我们的坐标 $\frac{y}{x}$ 应该在之前没有出现过，所以我们的朴素想法就是求出我们所有点的 $\frac{y}{x}$，然后观察有多少个 k 值出现过，但是因为我们这一题的棋盘是固定的，并且数据范围很大。所以我们就不能够这么求，我们发现，如果一个人可以被发现，那么就等价于 $gcd(x,y)=1$,

假设我的位置为 (0,0)我们考虑什么时候一个点会被挡住，显然当 $x\not\bot y$ 的时候会被
$(\frac{x}{gcd(x,y)},\frac{y}{(x,y)})$ 挡住。那么问题就变成了有多少对 $(x,y)$ 满足
$gcd(x,y)=1(1\leq x\leq n-1,1\leq y\leq n-1)$ 。显然如果 $(x,y)$ 是一组解那么 $(y,x)$ 也是一组解，那么我们可以规定 $y\leq x$ 然后把答案乘以二就行了。考虑对于每一个 $x$ 有多少个$y\leq x$ 与他互质，我们发现这个其实就是 $\varphi(x)$ 的定义，于是答案等于 $2\sum_{i=1}^{n-1}\varphi(i)+3$ (不要忘记了 (0,1), (1,0) 和 (1,1) )

于是，我们就可以进行一波推式子：
所以我们原来的问题就等价于**求我们 n 上的欧拉函数**。我们的原本的条件，**满足我们的欧拉函数的定义**，于是，我们考虑怎么快速的求出我们的 $\phi(n)$。

我们卡吕存在下面的公式：
1. 对于一个质数 $m$，如果 $m$ 和 $n$ 沪指，那么我们就有 $\phi(nm)=\phi(n)\phi(m)$，这一点由我们的积性函数得到
2. 对于一个质数 $m$，如果 $m$ 和 $n$ 不互质，那么我们就有：$\phi(nm)=\phi(n)m$。
```cpp

        for(int i=1;i<=n;++i)e[i]=i;
        for(int i=2;i<=n;++i){
            if(e[i]==i){
                for(int j=i;j<=n;j+=i){
                    e[j]=e[j]/i*(i-1);
                }
            }
        }

```

或者我们也有下面的一种筛法：
```
```cpp
for(int i = 2; i < N; ++i) {
	if(!vis[i]) {
		p[++cnt] = i;
		phi[i] = i - 1; 
	}
	
	for(int j = 1; j <= cnt && p[j] * i < N; ++j) {
		vis[i * p[j]] = 1;
		if(i % p[j]) phi[i * p[j]] = phi[p[j]] * phi[i];
		else { phi[i * p[j]] = p[j] * phi[i]; break; }
	}
}
```
```