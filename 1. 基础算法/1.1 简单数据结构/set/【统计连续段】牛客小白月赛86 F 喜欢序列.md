小蓝喜欢一种特殊的序列：$x,x+1,x+2,x+3,...$（其中 $x$ 可以是任意整数）。  
  
小灰灰现在获得了一个长度为 $n$ 的数组：$A_1, A_2,..., A_n$，他打算将这个数组拆分成连续的若干段，其中每一段都是小蓝喜欢的序列。  
  
若小灰灰将数组拆分成了 $k$ 个连续的段，其中第 $i$ 个连续段的长度记为 $s_i$ 那么小蓝对小灰灰的崇拜度就是：$\sum_{i = 1}^{k}s_i^2$。  
  
小红听说了这件事后给小灰灰上了点难度，小红将会进行 $m$ 次操作，第 $i$ 次操作会选取一个区间 $[l_i, r_i]$ 并将区间中所有数都加上 $w_i$。  
  
请你帮小灰灰求出每一次操作后他在最优拆分方式下可以获得的最大崇拜度是多少。

## 输入
小蓝喜欢一种特殊的序列：$x,x+1,x+2,x+3,...$（其中 $x$ 可以是任意整数）。  
  
小灰灰现在获得了一个长度为 $n$ 的数组：$A_1, A_2,..., A_n$，他打算将这个数组拆分成连续的若干段，其中每一段都是小蓝喜欢的序列。  
  
若小灰灰将数组拆分成了 $k$ 个连续的段，其中第 $i$ 个连续段的长度记为 $s_i$ 那么小蓝对小灰灰的崇拜度就是：$\sum_{i = 1}^{k}s_i^2$。  
  
小红听说了这件事后给小灰灰上了点难度，小红将会进行 $m$ 次操作，第 $i$ 次操作会选取一个区间 $[l_i, r_i]$ 并将区间中所有数都加上 $w_i$。  
  
请你帮小灰灰求出每一次操作后他在最优拆分方式下可以获得的最大崇拜度是多少。

## 输出：
输出共 $m$ 行，第 $i$ 行代表在 $i$ 次操作后小灰灰能获得的最大崇拜度。

## 题解
我们这一题的思路首先是把我们的区间修改变化为我们的单点修改。这里有两个原因：一个原因是这么做省时间。，另一个原因是这么做我们能够把我们的原本的特殊序列，转换为我们的起始位置不是 1，剩下位置是大于 1 的长度是多少。

然后我们的问题就是变成计算我们每一次修改后，对我们的答案的修改是多少。这里，我们按照每一次修改后这个位置的数是多少分类。

如果我们修改的点是原来连续的，我们就从原来的那个 set 中把我们的原来的拆分成两个部分，第一个是 $[l,i-1]$ 另一个部分是 $[i,r]$。

如果我们修改的点原先是两侧不连续的，那么我们就先检查我们两侧对应的是否能够合并，如果可以合并，我们就把我们的两个片段合成为一个完整的片段。

最后计算的时候，我们暴力的计算我们每个片段的长度是多少，然后再去平方。或者我们再修改的时候就维护一个全局的答案。
```cpp
#include <bits/stdc++.h>
using namespace std;
typedef pair<int,int> Pii;
int n,m;
long long sum,d[200010],a[200010];
set<pii> st;
void add(int l,int r){
	st.insert({l,r});
	sum+=(r-l+1)*(r-l+1);
}
void del(int l,int r){
	st.erase({l,r});
	sum-=(r-l+1)*(r-l+1);
}
void work(int pos,int c){
	if(pos==1||pos==n+1) return;
	d[pos]+=c;
	if(d[pos]==1){
		auto [l,r]=*st.lowerbound({pos,-1});//找到我们的当前线段
		auto [l1,_]=*prev(St.lower_bound({pos,-1}));//找到我们当前线段的上一段 
		del(l,r);
		del(l1,pos-1);
		add(l1,r); 
	}else if(d[pos]-c==1){
		autu [l,r]=*prev(st.lower_bound({pos,-1}));
		del(l,r)l
		add(l,pos-1);
		add(pos,r);
	}
}
int main(){
	cin>>n>>m;
	for(int i=1;i<=n;i++){
		cin>>a[i];
		d[i]=a[i]-a[i-1];
	}
	for(int i=1;i<=n;i++){
		int j=i+1;
		while(j<=n&&d[j]==1) j++;
		j--;
		add(i,j);
		i=jl
	}
	int l,r;
	long long w;
	while(m--){
		cin>>l>>r>>w;
		if(w!=0){
			work(l,w);
			work(r+1,-w);
		}
		cout<<sum<<endl;
	}
}
```