# 「HCOI-R 1」孤独的 sxz

## 题目背景

Sxz 不擅长与人交往，于是他平常都喜欢找偏僻的地方坐着。今天，sxz 来到了食堂，他依旧想找一个偏僻的地方坐着，让他与其他所有人的曼哈顿距离之和最大。

## 题目描述

食堂的座位可以看成一个被划分为 $n\times m$ 的格子的矩形，长为 $n$，宽为 $m$，矩形内的每一个格子 $(i, j)(i \in [1, n], j \in [1, m])$ $(i,j$ 为整数 $)$ 都是一个座位。

现在，食堂里已经有了 $k$ 个人，其中第 $i(1 \leq i \leq k)$ 个人坐在 $(x_i, y_i)$ 处。Sxz 想要找到一个座位，使得该座位与 $k$ 个人的曼哈顿距离之和最大。请你帮他找到这个最大值，剩下的就交给 sxz 吧！

假设 sxz 坐在点 $(a,b)$，那么他和 $k$ 个人的曼哈顿距离之和是 $\sum_{i=1}^{k}|a-x_i|+|b-y_i|$。

**很显然，sxz 不能和 $\bm k$ 个人中的任何一个人坐在同一个地方**。

## 输入格式

第一行包含三个整数 $n, m, k$。

接下来 $k$ 行，第 $i$ 行两个整数描述 $x_i, y_i$。

## 输出格式

仅一行一个整数，描述这个值。注意它可能很大。

## 样例 #1

### 样例输入 #1

```
2 5 3
1 1
1 3
1 4
```

### 样例输出 #1

```
10
```

## 样例 #2

### 样例输入 #2

```
7 4 9
1 4
2 3
4 1
6 2
7 1
5 2
3 4
1 1
7 4
```

### 样例输出 #2

```
38
```

## 提示

### 样例解释 1

最佳位置为 $(2,5)$，对于 $3$ 个人的曼哈顿距离分别为 $5, 3, 2$。

### 数据规模与约定

**本题采用捆绑测试。**
+ Subtask 0（15 pts）：$n, m \leq 100$。
+ Subtask 1（25 pts）：$n, m \leq 10000$。
+ Subtask 2（20 pts）：$k = 3$。
+ Subtask 3（40 pts）：无特殊限制。

对于所有数据，$1 \leq n, m \leq 10^9$，$1\leq k \leq \min\{4 \times 10^5, n\times m-1\}$，$1 \leq x_i \leq n$，$1 \leq y_i \leq m$，保证所有 $(x_i, y_i)$ 互不相同。

## 题解
首先，我们需要前置知识：我们在已经有了 $k$ 个点，我们需要添加一个新的点 $(x,y)$ 的时候，我们的新的曼哈顿距离和是多少。

**我们考虑分别计算我们的 $x,y$，**。然后我们对于新添加的一个点，我们可以二分求出，第一个比这个点还要小的点，我们记这个点位 $i$,这个时候，我们的总距离就是我们的 $\sum x-x_{i}+\sum x_{j}-x$。这一步可以通过我们的前缀和 $o(1)$ 的求出我们的问题。

令 $a\geq x_i$ 部分的右端点下表为 $p$,则考虑计算当 $a=x_p$ 时，$\sum_{i=1}^pa-x_i$。
即 $ap-\sum_{i=1}^px_i.$
然后再加上 $a-x_p$,答案为 $p(a-x_p)+ap-\sum_{i=1}^px_i$同理可得 $a<x_i$ 部分答案为 $(n-p)(x_{p+1}-a)+\sum_{n+1}^nx_i-(n-p)a$

于是，我们最后就可以 $o(\log n)$ 的求解我们的问题。

**接下来，我们考虑怎么去求出我们嫩的每一个点的位置**。这个时候，显然我们有：我们的四个角落是最优的，那么如果我们的四个角落被占领了怎么办？我们可以选择这四个角落扩展形成的连通块中，所有的点。**这些点都是可选的点**。

