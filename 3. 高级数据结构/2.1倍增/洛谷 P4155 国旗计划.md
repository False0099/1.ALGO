# [SCOI 2015] 国旗计划

## 题目描述

A 国正在开展一项伟大的计划 —— 国旗计划。这项计划的内容是边防战士手举国旗环绕边境线奔袭一圈。这项计划需要多名边防战士以接力的形式共同完成，为此，国土安全局已经挑选了 $N$ 名优秀的边防战上作为这项计划的候选人。


A 国幅员辽阔，边境线上设有 $M$ 个边防站，顺时针编号 $1$ 至 $M$。每名边防战士常驻两个边防站，并且善于在这两个边防站之间长途奔袭，我们称这两个边防站之间的路程是这个边防战士的奔袭区间。$N$ 名边防战士都是精心挑选的，身体素质极佳，所以每名边防战士的奔袭区间都不会被其他边防战士的奔袭区间所包含。


现在，国十安全局局长希望知道，至少需要多少名边防战士，才能使得他们的奔袭区间覆盖全部的边境线，从而顺利地完成国旗计划。不仅如此，安全局局长还希望知道更详细的信息：对于每一名边防战士，在他必须参加国旗计划的前提下，至少需要多少名边防战士才能覆盖全部边境线，从而顺利地完成国旗计划。

## 输入格式

第一行，包含两个正整数 $N,M$，分别表示边防战士数量和边防站数量。


随后 $N$ 行，每行包含两个正整数。其中第 $i$ 行包含的两个正整数 $C_i$、$D_i$ 分别表示 $i$ 号边防战士常驻的两个边防站编号，$C_i$ 号边防站沿顺时针方向至 $D_i$ 号边防站力他的奔袭区间。数据保证整个边境线都是可被覆盖的。

## 输出格式

输出数据仅 $1$ 行，需要包含 $N$ 个正整数。其中，第 $j$ 个正整数表示 $j$ 号边防战士必须参加的前提下至少需要多少名边防战士才能顺利地完成国旗计划。

## 样例 #1

### 样例输入 #1

```
4 8
2 5
4 7
6 1
7 3
```

### 样例输出 #1

```
3 3 4 3
```

## 提示

$N\leqslant 2×10^5,M<10^9,1\leqslant C_i,D_i\leqslant M$。

## 题解
首先，我们发现这是一个环形问题，并且我们还要求我们以每个人为起点时，我们的最短，所以我们考虑进行一个破环为链，我们把**每一个战士都复制一份，并且这些战士对应的区间也要加上对应的值**

把我们原来的一个环加倍后变成两个链，这样我们就能够变成**线段覆盖问题**，即我们**给定若干条线段，问至少要多少条线段才能把我们的整个区间给覆盖**。关于这一步，我们考虑线段不包含，我们选定**每一个人后的下一步都是唯一的**，这是因为我们要**贪心的覆盖更多的区域**。因此，我们这里要先计算出每个 i 的下一条线段，然后倍增求出每条线段的下 $2^k$ 条线段。对于每一次询问，倍增至 $d_{j}<c_{i}+m$ 即可，最后要把我们的答案+2.

因此，我们构造一个 ST 表，用来维护**我们从 k 点出发，贪心的跳了 $2^i$ 次后，我们到达的人的编号**


```cpp
#include<bits/stdc++.h>
using namespace std;
#define ll long long
const int N=2e5+10;
int n,m,answ[N];
int st[20][N<<1];
struct segment{
	int l,r,id;
	inline friend bool operator<(const segment &a,const segment &b){
		return a.l<b.l;
	}
}a[N<<1];
int main(){
	n=read(),m=read();
	for(int i=1;i<=n;i++){
		int l=read(),r=read();
		if(l>r) r+=m;
		a[i].l=l,a[i].r=r,a[i].id=i;
	}
	sort(a+1,a+n+1);
	for(int i=1;i<=n;i++)
		a[i+n].l=a[i].l+m,a[i+n].r=a[i].r+m;
	for(int i=1,j=1;i<=2*n;i++){
		while(j<=2*n&&a[j].l<=a[i].r)
			j++;
		st[0][i]=j-1;
	}
	for(int i=1;i<=19;i++)
		for(int j=1;j<=2*n;j++)
			st[i][j]=st[i-1][st[i-1][j]];
	for(int i=1;i<=n;i++){
		int up=a[i].l+m,ans=0,p=i;
		for(int j=19;j>=0;j--)
			if(st[j][p]&&a[st[j][p]].r<up)
				ans+=1<<j,p=st[j][p];
		answ[a[i].id]=ans+2;
	}
	for(int i=1;i<=n;i++)
		write(answ[i]),putc(' ');
	flush();
}
```
```