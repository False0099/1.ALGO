# [COCI 2022-2023 #4 ] Vrsta

## 题目描述

Domagoj 最喜欢的课是体育课。每节体育课都以热身运动开始。体育老师有一个有趣的方法来选择带领其他同学做热身运动的学生。学生们按身高从低到高的顺序站成一排，老师会选择站在队伍中间的学生。如果有两个学生在中间，他将选择较矮的那个。例如：如果学生的身高为 $1, 3, 5, 7, 11$，身高为 $5$ 的学生将带领其他同学做热身运动。

Domagoj 记不住他同学的身高。幸运的是，站在他旁边的 Lovro 十分擅长估计他人的身高。他给了 Domagoj $n$ 条信息：「有 $a_i$ 个身高为 $v_i$ 的学生进入了体育馆。」在 Lovro 说完每条信息之后，Domagoj 都对带领其他同学做热身运动的那个同学的身高感兴趣。假定所有进入体育馆的同学都是来上体育课的。请帮他回答他的问题！

## 输入格式

第一行一个整数 $n\ (1\le n\le 200\ 000)$，表示 Lovro 的信息条数。

接下来 $n$ 行包含两个整数 $v_i,a_i\ (1\le v_i,a_i\le 10^9)$，表示 Lovro 所给信息中的身高和人数。

## 输出格式

输出 $n$ 行，表示在 Lovro 给出第 $i$ 条信息后，对 Domagoj 问题的回答。

## 样例 #1

### 样例输入 #1

```
3
2 1
3 1
1 1
```

### 样例输出 #1

```
2
2
2
```

## 样例 #2

### 样例输入 #2

```
4
17 2
23 5
11 4
9 5
```

### 样例输出 #2

```
17
23
17
11
```

## 样例 #3

### 样例输入 #3

```
3
10 20
100 5
1000 5
```

### 样例输出 #3

```
10
10
10
```

## 提示

|子任务编号|	附加限制|	分值|
|:-:|:-:|:-:|
| $0$ | 是样例 | $0$ |
| $1$ | $n,v_i\le 1000$ | $17$ |
| $2$ | $a_1=a_2=\ldots=a_n=1$ | $24$ |
| $3$ | $v_1<v_2<\ldots <v_n$ |	$26$ |
| $4$ |	无附加限制 |	$33$ |
## 题解
我们本题就是非常模板的，给我们下面两种操作：
1. 我们向我们的集合中添加 $a[i]$ 个身高为 $h[i]$ 的人
2. 求我们当前所有人的中位数是多少。

考虑到我们的动态第 $K$ 大的方法，
1. set，首先排除这一种方法，因为这一种方法只对我们的单次修改有用
2. 主席树，可行，但是我们需要离散化处理我们的原数组
3. 平衡树，可行，但是我们需要离散化处理我们的原数组
4. 树状数组，可行，同样的，我们需要使用一个权值线段树，我们在这个权值线段树上二分答案+在线查找，时间复杂度达到 $o(n\log n)$。

```cpp
#include <bits/stdc++.h>
using namespace std;
#define int long long
int lowbit(int x){
	return x&(-x);
}
const int N=2e6+10;
int n;
int sum;
int tr[N];
int v[N];
int a[N];
int b[N];
void add(int a,int b){
	for(int i=a;i<=n;i+=lowbit(i)){
		tr[i]+=b;
	}
}
int query(int a){
	int ans=0;
	for(int i=a;i>0;i-=lowbit(i)){
		ans+=tr[i];
	}
	return ans;
}
signed main(){
	cin>>n;
	for(int i=1;i<=n;i++){
		cin>>v[i]>>a[i];
		b[i]=v[i];
	}
	sort(b+1,b+1+n);
	auto bin=[](){
		int l=1,r=n;
		while(l<=r){
			int mid=l+r>>1;
			if(query(mid)>=(sum+1)/2){
				r=mid-1;
			}else{
				l=mid+1;
			}
		}
		return l;
	};
	for(int i=1;i<=n;i++){
		v[i]=lower_bound(b+1,b+n+1,v[i])-b;
		sum+=a[i];
		//cout<<v[i]<<" "<<a[i]<<" "<<endl;
		add(v[i],a[i]);
		cout<<b[bin()]<<endl;
	}
}
```
