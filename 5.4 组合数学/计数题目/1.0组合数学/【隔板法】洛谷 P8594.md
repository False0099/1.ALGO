# 「KDOI-02」一个仇的复

## 题目背景

**本题由于 OI 赛制，关闭 subtask，可能会放部分错解高分，赛后将开启 subtask。**

「听说那件事了吗？愿他们安息。」  
「诶？你看，前面那座环形建筑是什么？」  
「等我对比一下……啊哈！这就是他们的老巢！」  
「捣毁了它，为牺牲的同志们报仇！！！」  
死亡的宇宙射线指向了脆弱的文明，正准备发出它震耳欲聋的怒吼。

## 题目描述

外星人的空间站是一个环形结构。不过，由于环的两段不连通，因此可以将其近似为 $2\times n$ 的平面网格。目前，地方飞船有 $n$ 种不同规格的射线武器，作用范围是 $1\times x$（$x$ 为正整数）的长方形。并且，武器可以往顺时针或逆时针方向旋转 $90^\circ$。射线十分强力，只需一发便可与作用范围平面内的所有物体相湮灭。不过，只要宇宙射线的一部分作用范围落到目标外，便会一直延续到宇宙尽头，贪婪地吞噬沿途的一切。指挥官当然不想危害到无辜文明，他想知道，在这 $n$ 中武器中选出 $k$ 种，共有多少种不同的摧毁飞行器的方式。

**【形式化题意】**

你有 $1\times x$（$x$ 为任意正整数）的矩形各无穷多个和一个 $2\times n$ 的网格，请求出恰好选择其中 $k$ 个矩形（可以选择相同的矩形）**不重不漏**地铺满整个网格的方案数。矩形可以旋转。

## 输入格式

从标准输入中读入数据。

输入共包含一行两个正整数 $n,k$。

## 输出格式

输出到标准输出。

输出一行一个正整数，表示方案数，答案对 $998244353$ 取模。

## 样例 #1

### 样例输入 #1

```
4 3
```

### 样例输出 #1

```
8
```

## 样例 #2

### 样例输入 #2

```
15 5
```

### 样例输出 #2

```
4015
```

## 样例 #3

### 样例输入 #3

```
3050 1314
```

### 样例输出 #3

```
670638639
```

## 样例 #4

### 样例输入 #4

```
19198114 4154
```

### 样例输出 #4

```
264122135
```

## 提示

****
**【样例解释】**
+ **样例 1 解释：**  
共有如下图所示的 $8$ 种方案。  
![](https://cdn.luogu.com.cn/upload/image_hosting/iko97ksh.png)

***
**【数据范围】**

对于 $100\%$ 的数据，$1\le n\le 2\times 10^7$，$1\le k\le 5000$。

| 测试点编号 | 分值 | $n$ | $k$ |
| :----------: | :----------: | :----------: | :----------: |
| $1\sim 5$ | $2$ | $\leq5$ | $\leq10$ |
| $6\sim 10$ | $2$ | $\leq1000$ | $=2n$ |
| $11\sim 15$ | $2$ | $\leq10^6$ | $\leq3$ |
| $16\sim 20$ | $4$ | $\leq1000$ | $\leq2n$ |
| $21\sim 25$ | $4$ | $\leq2\times10^7$ | $\leq100$ |
| $26\sim 30$ | $4$ | $\leq10^6$ | $\leq5000$ |
| $31\sim 40$ | $1$ | $\leq2\times10^7$ | $\leq5000$ |

注意：分值一列指的是单个测试点分值。


## 题解
我们首先考虑一个简化版的问题，如果我们只用**横着**的长方形铺，那么我们的原问题就可以转化为：我们在上面一行铺 i 个，下面一行铺 j 个个，然后要求满足：$x_{1}+\dots+x_{i}=y$, 
$y_1+...+y_n=y$。
于是，我们就有：
$$Ans=\sum_{i=0}^b\binom{a-1}{i-1}\binom{a-1}{b-i-1}\text{。}$$

考虑范德蒙德卷积，我们原式就可以转化为：
$$Ans=\binom{2a-2}{b-2}。$$


然后我们在考虑用 j 个 $1\times2$ 的木板来把原来的大木板分割成 i 个 $2 \times a_k$ 个小区间，再套用上述问题的子公式，我们就有：
$$d_0+d_1+d_2+\ldots+d_i=j\text{,其中 }d_0,d_i\geq0\text{,}d_1,d_2\ldots d_{i-1}\geq1\text{。}$$

再次运用隔板法，我们这里的方案数就是：$$\binom{n-j-1}{i-1}。$$
最后考虑填剩下的 i 个小区间，我们就有：
$$\sum_{(\sum_{l=1}^ib_l)=k-j}\prod_{l=1}^i\binom{2a_l-2}{b_l-2}\text{。}$$

考虑范德蒙德卷积，这里实际上可以看成是在 $\sum(2a_l-2)$ 个空格中选择 $\sum(b_l-2)$ 个空格插入，那么合起来的方案数就是： $\begin{pmatrix}2n-2j-2i\\k-j-2i\end{pmatrix}。$
 最终还需要考虑特判 $n=k$ 的情况，只有这种情况下可以用 $k\uparrow1\times2$ 的长方形竖着填满大木板。那么最终的答案就是：

$$
Ans=\sum_{j=0}^k\sum_{i=1}k\binom{2n-2j-2i}{k-j-2i}\binom{j+1}i\binom{n-j-1}{i-1}+[n==k]。
$$

```cpp
#include<cstdio>
#include<cstring>
#include<algorithm>
using namespace std;
const int N=4e7+10,mod=998244353;
int fac[N],infac[N],inv[N],n,k,ans;
void init()
{
	fac[0]=infac[0]=fac[1]=infac[1]=inv[0]=inv[1]=1;
	for(int i=2;i<N;i++) fac[i]=1ll*fac[i-1]*i%mod;
	for(int i=2;i<N;i++) inv[i]=1ll*(mod-mod/i)*inv[mod%i]%mod;
	for(int i=2;i<N;i++) infac[i]=1ll*infac[i-1]*inv[i]%mod;
}
int C(int n,int m){if(n<0||m<0||n<m) return 0;return 1ll*fac[n]*infac[m]%mod*infac[n-m]%mod;}
void add(int &a,int b){a+=b;if(a>=mod) a-=mod;}
int main()
{
	scanf("%d%d",&n,&k);init();ans=(n==k);
	for(int j=0;j<=k;j++) for(int i=1;i<=k;i++) add(ans,1ll*C(2*n-2*j-2*i,k-j-2*i)*C(j+1,i)%mod*C(n-j-1,i-1)%mod);
	printf("%d\n",ans);
	return 0;
}

```